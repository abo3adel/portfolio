<template>
    <nav
        id="navbar-top"
        class="navbar navbar-expand-sm navbar-dark trans"
        :class="[cls, $route.path === '/' ? 'fixed-top' : 'sticky-top']"
    >
        <nuxt-link :to="localePath('/')" class="navbar-brand">
            NinjaCoder
        </nuxt-link>
        <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
        >
            <!-- <span class="navbar-toggler-icon"></span> -->
            <span id="navbarDropdown" class="nav-link">
                <img
                    class="img d-inline rounded-circle pr-1"
                    src="/myImg.jpeg"
                    width="35"
                    height="35"
                />
                Ahmed Adel
            </span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <nuxt-link class="nav-link" :to="localePath('/')">
                        {{ $t('nav.portfolio') }}
                        <span class="sr-only">(current)</span>
                    </nuxt-link>
                </li>
                <li class="nav-item">
                    <nuxt-link class="nav-link" :to="localePath('/blog')">
                        {{ $t('nav.blog') }}
                    </nuxt-link>
                </li>
                <li class="nav-item dropdown">
                    <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        id="navbarDropdown"
                        role="button"
                        data-toggle="dropdown"
                        aria-haspopup="true"
                        aria-expanded="false"
                    >
                        <i class="fas fa-language"></i>
                        {{ $t('nav.lang') }}
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <nuxt-link
                            v-for="locale in availableLocales"
                            :key="locale.code"
                            :to="switchLocalePath(locale.code)"
                            class="dropdown-item"
                            :class="
                                locale.code === 'ar'
                                    ? 'text-right'
                                    : 'text-left'
                            "
                        >
                            {{ locale.name }}
                        </nuxt-link>
                    </div>
                </li>
            </ul>

            <!-- right nav -->
            <ul class="navbar-nav ml-auto">
                <li class="nav-item text-light">
                    <img
                        class="img d-inline rounded-circle pr-1"
                        src="/myImg.jpeg"
                        width="35"
                        height="35"
                    />
                    Ahmed Adel
                </li>
            </ul>
        </div>
    </nav>
</template>
<script lang="ts">
import { Vue, Component } from 'vue-property-decorator'

@Component
export default class Nav extends Vue {
    public cls: string = 'bg-primary'

    get availableLocales() {
        // @ts-ignore
        return this.$i18n.locales.filter((i) => i.code !== this.$i18n.locale)
    }

    public isScrolled() {
        if (this.$route.path !== '/') {
            window.removeEventListener('scroll', this.isScrolled)
        }

        const header = document.querySelector(`#canvasHeader`) as HTMLDivElement
        if (window.scrollY >= header.offsetHeight - 30) {
            this.cls = 'bg-primary'
            return
        }
        this.cls = 'bg-transparent'
    }

    mounted() {
        if (this.$route.path === '/') {
            this.cls = 'bg-transparent'
            window.addEventListener('scroll', this.isScrolled)
        }
    }
}
</script>
<style lang="scss"></style>
